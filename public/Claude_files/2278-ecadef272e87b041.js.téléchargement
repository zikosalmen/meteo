"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2278],{12278:(e,t,r)=>{r.r(t),r.d(t,{default:()=>eY});var n=r(54568),s=r(19354),a=r(24407);a.z.object({name:a.z.string().optional(),url:a.z.string().optional(),type:a.z.string().optional()});let o=["api.anthropic.com"],l=new Map;function i(e){let t=window.fetch;return window.fetch=async function(r,n){let a=new Request(r,n),i=new URL(a.url);if(!o.some(e=>i.hostname===e))return t(a);let c="fetch-".concat(Date.now(),"-").concat(Math.random()),d=null;try{d=await a.arrayBuffer()}catch(e){d=null}try{let t=await e.sendRequest(s.uZ.ProxyFetch,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.ProxyFetchRequest",url:a.url,method:a.method,headers:Object.fromEntries(a.headers.entries()),body:d,channelId:c});if(!t||"object"!=typeof t)throw Error("Invalid response from proxy");let r=new ReadableStream({start(e){l.set(c,e)},cancel(){l.delete(c)}}),{status:n,statusText:o,headers:i}=t;return new Response(r,{status:n,statusText:o,headers:new Headers(i)})}catch(e){throw l.delete(c),e}},()=>{window.fetch=t,l.clear()}}function c(e,t,r,n){let s=l.get(e);s&&(n?(s.error(Error(n)),l.delete(e)):r?(s.close(),l.delete(e)):t&&s.enqueue(new Uint8Array(t)))}let d=new Map,u=()=>{let e=URL.createObjectURL.bind(URL),t=URL.revokeObjectURL.bind(URL);return window.originalCreateObjectUrl=e,URL.createObjectURL=e=>{let t="blob-".concat(Date.now(),"-").concat(Math.random());return d.set(t,e),"blob-request://".concat(t)},URL.revokeObjectURL=e=>{let t=e.replace("blob-request://","");d.delete(t)},()=>{URL.createObjectURL=e,URL.revokeObjectURL=t,window.originalCreateObjectUrl=void 0,d.clear()}},m=e=>{let t=e.replace("blob-request://","");return d.get(t)};var h=r(7620),f=r(97905);function p(e){let{parentWindow:t,allowedOrigins:r,onOutsideRequest:n}=e,[s,a]=(0,h.useState)(null);(0,h.useEffect)(()=>{if(t){let e=new f.m({parentWindow:t,allowedOrigins:r,onOutsideRequest:n});a(e);let s=i(e),o=u();return()=>{e.cleanup(),s(),o()}}},[t,r,n]);let o=(0,h.useCallback)(async(e,t)=>{if(s)return s.sendRequest(e,t);throw Error("Communicator not initialized")},[s]);return{sendRequest:null===s?void 0:o}}function g(e,t){switch(e.type){case"UnsupportedImports":return{title:t?t.formatMessage({defaultMessage:"Artifact failed to load",id:"NcDXiSfIPe"}):"Artifact failed to load",description:t?t.formatMessage({defaultMessage:"The generated artifact uses libraries we don’t support:",id:"HG0Hu8xIQA"}):"The generated artifact uses libraries we don’t support:",inset:[...e.unsupportedModules,...e.nonExistentIcons.map(e=>"{ ".concat(e,' } from "lucide-react"'))],subtext:t?t.formatMessage({defaultMessage:"The code itself may still work. To use it, you’ll need a development setup with these libraries installed.",id:"Et/uvuRBba"}):"The code itself may still work. To use it, you’ll need a development setup with these libraries installed."};case"RuntimeError":return{title:t?t.formatMessage({defaultMessage:"Error running artifact",id:"JU2kK1J3jY"}):"Error running artifact",description:t?t.formatMessage({defaultMessage:"An error occurred while trying to run the generated artifact.",id:"3RpkNRAyPc"}):"An error occurred while trying to run the generated artifact.",inset:[e.message],insetStyle:"danger"};case"FileNotFound":return{title:t?t.formatMessage({defaultMessage:"File not found",id:"gcaJtRf4b0"}):"File not found",description:t?t.formatMessage({defaultMessage:"The file “{fileName}” could not be found.",id:"0kOCGtB3eN"},{fileName:e.fileName}):"The file “".concat(e.fileName,"” could not be found."),subtext:t?t.formatMessage({defaultMessage:"Please check the file name and try again.",id:"/fdYJU5SMC"}):"Please check the file name and try again."};case"ClaudeCompletionError":return{title:t?t.formatMessage({defaultMessage:"Error in Claude completion",id:"ya5HK9oB9T"}):"Error in Claude completion",description:e.message};case"ArtifactStorageError":return{title:t?t.formatMessage({defaultMessage:"Error accessing shared data",id:"hjqZygykww"}):"Error accessing shared data",description:e.message}}}var y=r(57291),x=r(73356),b=r(81384),w=r(93124),v=r(27541),E=r(27694);function S(e){let{enabled:t,children:r,sendRequest:a}=e,o=(0,h.useRef)(null);return((0,h.useLayoutEffect)(()=>{if(!o.current||!a||!t)return;let e=new ResizeObserver(e=>{let t=e[0].contentRect.height,r=e[0].contentRect.width;r&&t&&a(s.uZ.BroadcastContentSize,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.BroadcastContentSizePayload",height:t,width:r})});return e.observe(o.current),()=>{e.disconnect()}},[a,t]),t)?(0,n.jsx)("div",{ref:o,children:r}):r}let j=100,R=20,C=120,N=50,T=e=>null!==e&&"object"==typeof e&&"value"in e,M=e=>T(e)?e.value:e,A=e=>{if(T(e))return e.formula};function k(e){var t,r;let{sheetName:s,data:a,selectedCell:o,onCellSelect:l,isFirstRowHeader:i=!1,formulaBar:c=!1}=e,d=Math.min(Math.max(...a.map(e=>(null==e?void 0:e.length)||0)),R),[u,m]=(0,h.useState)(()=>Array(d).fill(C)),[f,p]=(0,h.useState)(!1),g=(0,h.useRef)(0),y=(0,h.useRef)(0),x=(0,h.useRef)(null),b=(0,h.useCallback)(e=>{let t="";for(;e>=0;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t},[]),w=(0,h.useCallback)(e=>null==e?"":String(e),[]),v=(0,h.useCallback)(e=>{let t=A(e);return t?"=".concat(t):w(M(e))},[w]),E=(0,h.useCallback)(e=>{let t=e.clientX-g.current,r=Math.max(C,y.current+t);m(e=>{let t=[...e];return null!==x.current&&(t[x.current]=r),t})},[]),S=(0,h.useCallback)(()=>{document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",S),x.current=null,p(!1)},[E]),T=(0,h.useCallback)((e,t)=>{e.preventDefault(),e.stopPropagation(),m(e=>(y.current=e[t],e)),g.current=e.clientX,x.current=t,p(!0),document.addEventListener("mousemove",E),document.addEventListener("mouseup",S)},[E,S]);return a.length?(0,n.jsx)("div",{className:"flex-1 min-h-0 w-full bg-gray-50",style:{cursor:f?"col-resize":void 0},children:(0,n.jsxs)("div",{className:"flex flex-col h-full bg-white rounded-sm border border-gray-200 overflow-hidden",children:[c&&(0,n.jsx)("div",{className:"bg-white border-b border-gray-300 px-3 py-2 min-h-[44px] flex items-center",children:(0,n.jsx)("div",{className:"text-sm text-gray-700 font-mono",children:o&&(null==(t=a[o.row])?void 0:t[o.col])?v(null==(r=a[o.row])?void 0:r[o.col]):(0,n.jsx)("span",{className:"text-gray-400",children:"Select a cell to view its content"})})}),(0,n.jsx)("div",{className:"flex-1 overflow-auto relative bg-gray-50",children:(0,n.jsxs)("table",{className:"border-collapse",style:{tableLayout:"fixed"},children:[(0,n.jsx)("thead",{className:"sticky top-0 z-20 bg-gray-200",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"sticky left-0 z-30 border-r border-b border-gray-300 bg-gray-300",style:{width:"".concat(N,"px"),minWidth:"".concat(N,"px")}}),Array.from({length:d}).map((e,t)=>(0,n.jsxs)("th",{className:"relative border-r border-b border-gray-300 bg-gray-200 px-4 py-2 text-xs font-semibold text-gray-700",style:{width:"".concat(u[t],"px"),minWidth:"".concat(u[t],"px")},children:[b(t),(0,n.jsx)("div",{className:"absolute top-0 -right-1 w-3 h-full cursor-col-resize hover:bg-blue-400 active:bg-blue-500 z-10",onMouseDown:e=>T(e,t)})]},t))]})}),(0,n.jsx)("tbody",{children:a.slice(0,j).map((e,t)=>{let r=i&&0===t;return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"sticky left-0 z-10 border-r border-b border-gray-300 bg-gray-200 text-center text-xs font-semibold text-gray-700",style:{width:"".concat(N,"px"),minWidth:"".concat(N,"px")},children:t+1}),Array.from({length:d}).map((s,a)=>{let i=null==e?void 0:e[a],c=M(i),d=A(i),m=(null==o?void 0:o.row)===t&&(null==o?void 0:o.col)===a;return(0,n.jsx)("td",{onClick:()=>l({row:t,col:a}),className:"border border-gray-300 px-2 py-1 text-sm cursor-cell ".concat(r?"font-semibold bg-gray-100":""," ").concat(m?"bg-blue-50 outline outline-2 outline-blue-500":r?"":"hover:bg-gray-50"),style:{width:"".concat(u[a],"px"),minWidth:"".concat(u[a],"px"),maxWidth:"".concat(u[a],"px")},children:d&&(!c||""===c)?(0,n.jsxs)("span",{className:"text-gray-400 italic",children:["=",d]}):w(c)},a)})]},t)})})]})})]})}):(0,n.jsx)("div",{className:"flex items-center justify-center min-h-[600px] bg-gray-50 rounded-lg",children:(0,n.jsx)("p",{className:"text-gray-500",children:"No data available"})})}let q=h.memo(k);function L(e,t){let r=e.split("\n").filter(e=>e.trim());if(0===r.length)return{headers:[],rows:[]};let n=e=>{let r=[],n="",s=!1;for(let a=0;a<e.length;a++){let o=e[a],l=e[a+1];"“"===o?s&&"“"===l?(n+="“",a++):s=!s:o!==t||s?n+=o:(r.push(n.trim()),n="")}return r.push(n.trim()),r},s=r.map(n),a=s[0]||[],o=s.slice(1).map(e=>{let t=[...e];for(;t.length<a.length;)t.push("");return t.slice(0,a.length)});return{headers:a,rows:o}}function P(e){let{content:t,delimiter:r=y.Yc.Comma}=e,[s,a]=(0,h.useState)(null),o=(0,h.useCallback)(e=>{a(e)},[]),l=(0,h.useMemo)(()=>{let e=L(t,r),n=[];return e.headers.length>0&&n.push(e.headers),e.rows.forEach(e=>{n.push(e.map(e=>e||null))}),n},[t,r]);return 0===l.length?(0,n.jsx)("div",{className:"flex items-center justify-center min-h-[600px] bg-gray-50 rounded-lg",children:(0,n.jsx)("p",{className:"text-gray-500",children:"No data available in this file"})}):(0,n.jsx)(q,{sheetName:"Data",data:l,selectedCell:s,onCellSelect:o,isFirstRowHeader:!0,formulaBar:!1})}let F=h.memo(P);var I=r(87993),D=r(54492),O=r(90955);async function U(e){let t=[];try{var r;let n=await (null==(r=e.files["xl/sharedStrings.xml"])?void 0:r.async("string"));if(!n)return t;let s=new DOMParser().parseFromString(n,"text/xml");if(s.querySelector("parsererror"))return t;s.querySelectorAll("si").forEach(e=>{let r=e.querySelector("t");if(null==r?void 0:r.textContent)t.push(r.textContent);else{let r=e.querySelectorAll("r t"),n=Array.from(r).map(e=>e.textContent||"").join("");t.push(n)}})}catch(e){}return t}async function W(e,t,r){let n={};for(let a=0;a<t.length;a++){let o=t[a],l=a+1;try{var s;let t=await (null==(s=e.files["xl/worksheets/sheet".concat(l,".xml")])?void 0:s.async("string"));if(!t)continue;let a=new DOMParser().parseFromString(t,"text/xml");if(a.querySelector("parsererror"))continue;let i=[],c=0,d=0;a.querySelectorAll("c").forEach(e=>{let t=e.getAttribute("r");if(!t)return;let n=t.match(/^([A-Z]+)/),s=t.match(/(\d+)$/);if(!n||!s)return;let a=B(n[1])-1,o=parseInt(s[1],10)-1;for(;i.length<=o;)i.push([]);for(;i[o].length<=a;)i[o].push(null);let l=e.getAttribute("t"),u=e.querySelector("v"),m=e.querySelector("is t"),h=null;if(null==m?void 0:m.textContent)h=m.textContent;else if(null==u?void 0:u.textContent){let e=u.textContent;if("s"===l)h=r[parseInt(e,10)]||e;else if("b"===l)h="1"===e;else if("e"===l)h="#ERROR: ".concat(e);else if("str"===l)h=e;else{let t=parseFloat(e);h=isNaN(t)?e:t}}i[o][a]=h,c=Math.max(c,o),d=Math.max(d,a)}),n[o]={data:i,maxRow:c,maxCol:d}}catch(e){}}return n}function B(e){let t=0;for(let r=0;r<e.length;r++)t=26*t+(e.charCodeAt(r)-64);return t}function z(e){if(!e)return null;e=e.replace(/[\u2018\u2019]/g,"’");let t="",r=e;if(e.includes("!")){let n=e.split("!");2===n.length&&(t=n[0],r=n[1],t.startsWith("'")&&t.endsWith("'")?t=t.slice(1,-1):t.startsWith("‘")&&t.endsWith("’")&&(t=t.slice(1,-1)))}let n=r.match(/^\$?([A-Z]+)\$?(\d+)(?::\$?([A-Z]+)\$?(\d+))?$/i);if(!n)return null;let s=B(n[1])-1,a=parseInt(n[2],10)-1,o=n[3]?B(n[3])-1:s,l=n[4]?parseInt(n[4],10)-1:a;return{sheet:t,startCol:s,startRow:a,endCol:o,endRow:l}}function _(e,t,r){let n=z(e);if(!n)return[];let s=n.sheet||r||Object.keys(t)[0],a=t[s];if(!a)return[];let o=[];for(let e=n.startRow;e<=n.endRow;e++)for(let t=n.startCol;t<=n.endCol;t++){var l;let r=null==(l=a.data[e])?void 0:l[t];void 0!==r&&o.push(r)}return o}let Z={goldenAngle:137.5,saturation:50,lightness:50,alpha:.7},H={barchart:"bar",linechart:"line",piechart:"pie",doughnutchart:"doughnut",areachart:"line",scatterchart:"scatter",radarchart:"radar"};async function G(e){let t=null,n=null;try{if("string"==typeof e){let r=atob(e),n=new Uint8Array(r.length);for(let e=0;e<r.length;e++)n[e]=r.charCodeAt(e);t=n.buffer}else t=e instanceof Blob?await e.arrayBuffer():e;n=new(await r.e(2313).then(r.t.bind(r,52313,23))).default,await n.loadAsync(t);let s=Object.keys(n.files).filter(e=>e.includes("/charts/chart")&&e.endsWith(".xml"));if(0===s.length)return{charts:[],hasCharts:!1};let a=!1;for(let e of s){let t=await n.files[e].async("string");if(t.includes("numRef")||t.includes("strRef")){a=!0;break}}let o={},l=await V(n);if(a){let e=await U(n);o=await W(n,l,e)}let i=await K(n,l),c=[];for(let e of s)try{let t=await n.files[e].async("string"),r=$(t)||i[e]||l[0]||"Sheet1";r=r.replace(/^[’\u0027\u2018\u2019]+|[’\u0027\u2018\u2019]+$/g,"").trim();let s=X(t,e,r,o);s&&c.push(s)}catch(e){}return{charts:c,hasCharts:c.length>0}}catch(e){return{charts:[],hasCharts:!1}}finally{t=null,n=null}}async function V(e){let t=[];try{var r;let n=await (null==(r=e.files["xl/workbook.xml"])?void 0:r.async("string"));if(n){let e=new DOMParser().parseFromString(n,"text/xml");e.querySelector("parsererror")||e.querySelectorAll("sheet").forEach(e=>{let r=e.getAttribute("name");r&&t.push(r)})}}catch(e){}return t}async function K(e,t){let r={};for(let l=0;l<t.length;l++){let i=l+1;try{var n,s,a,o;let c="xl/worksheets/_rels/sheet".concat(i,".xml.rels"),d=await (null==(n=e.files[c])?void 0:n.async("string"));if(!d)continue;let u=d.match(/drawing(\d+)\.xml/g);if(!u)continue;for(let n of u){let i=null==(s=n.match(/\d+/))?void 0:s[0];if(!i)continue;let c="xl/drawings/_rels/drawing".concat(i,".xml.rels"),d=await (null==(a=e.files[c])?void 0:a.async("string"));if(!d)continue;let u=d.match(/chart(\d+)\.xml/g);if(u)for(let e of u){let n=null==(o=e.match(/\d+/))?void 0:o[0];n&&(r["xl/charts/chart".concat(n,".xml")]=t[l])}}}catch(e){}}return r}function $(e){let t=e.match(/<(?:c:)?f[^>]*>([^<]+)<\/(?:c:)?f>/);if(t){let e=z(t[1]);if(null==e?void 0:e.sheet)return e.sheet}let r=e.match(/‘([^’]+)’!/);return r&&r[1]?r[1]:null}function X(e,t,r,n){try{let s=new DOMParser().parseFromString(e,"text/xml");if(s.querySelector("parsererror"))return null;let a=J(s);if(!a)return null;let o=Q(s),{labels:l,datasets:i}=Y(s,a,n,r);return{id:t.replace(/.*\/chart(\d+)\.xml/,"excel-chart-$1"),sheetName:r,chartType:a,title:o,data:{labels:l,datasets:i},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top"},title:{display:!!o,text:o}},scales:"pie"===a||"doughnut"===a?{}:{y:{beginAtZero:!0}}},metadata:{originalType:"excel-embedded"}}}catch(e){return null}}function J(e){for(let t of e.getElementsByTagName("*")){let e=t.tagName.toLowerCase();for(let[t,r]of Object.entries(H))if(e.includes(t))return r}return null}function Q(e){for(let r of e.querySelectorAll("title t, tx t")){var t;let e=null==(t=r.textContent)?void 0:t.trim();if(e&&"1"!==e&&"0"!==e)return e}}function Y(e,t,r,n){let s=[],a=[];return Array.from(e.getElementsByTagName("*")).filter(e=>"ser"===e.localName).forEach((e,o)=>{let l="Series ".concat(o+1),i=et(e,"tx","v");if((null==i?void 0:i.textContent)&&(l=i.textContent.trim()),0===s.length){let t=et(e,"cat");if(t){let e=ee(t,r,n,!0);s.push(...e.map(e=>String(e)))}}if("scatter"===t){let t=et(e,"xVal"),s=et(e,"yVal");if(t&&s){let e=ee(t,r,n,!1),i=ee(s,r,n,!1),c=[],d=Math.min(e.length,i.length);for(let t=0;t<d;t++){let r=er(e[t]),n=er(i[t]);isNaN(r)||isNaN(n)||c.push({x:r,y:n})}if(c.length>0){let e=en(o);a.push({label:l,data:c,backgroundColor:e,borderColor:e,borderWidth:1,showLine:!1})}}}else{let s=et(e,"val")||et(e,"yVal"),i=[];if(s&&ee(s,r,n,!1).forEach(e=>{let t=er(e);isNaN(t)||i.push(t)}),i.length>0){let e=en(o);a.push({label:l,data:i,backgroundColor:"line"===t?e:"pie"===t||"doughnut"===t?i.map((e,t)=>en(t)):e,borderColor:"pie"===t||"doughnut"===t?i.map((e,t)=>en(t)):e,borderWidth:1,fill:"line"!==t&&void 0})}}}),{labels:s,datasets:a}}function ee(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=[],a=et(e,"f");if((null==a?void 0:a.textContent)&&t){let e=_(a.textContent,t,r);if(e.length>0){let t=e.filter(e=>"string"==typeof e||"number"==typeof e);if(t.length>0)return t}}return Array.from((et(e,n?"strCache":"numCache")||e).getElementsByTagName("*")).filter(e=>"pt"===e.localName).forEach(e=>{let t=et(e,"v");(null==t?void 0:t.textContent)&&s.push(n?t.textContent:parseFloat(t.textContent))}),s}function et(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];let s=e;for(let e of r){if(!s)break;s=Array.from(s.getElementsByTagName("*")).find(t=>t.localName===e)||null}return s}function er(e){return"number"==typeof e?e:"string"==typeof e?parseFloat(e):NaN}function en(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{goldenAngle:r,saturation:n,lightness:s,alpha:a}={...Z,...t},o=e*r%360;return"hsla(".concat(o,", ").concat(n,"%, ").concat(s,"%, ").concat(a,")")}var es=r(98730),ea=r(46593);function eo(e){let{charts:t}=e,r=(0,h.useRef)([]),s=(0,h.useRef)([]),[a,o]=(0,h.useState)(0);(0,h.useEffect)(()=>(s.current.forEach(e=>null==e?void 0:e.destroy()),s.current=[],t.forEach((e,t)=>{let n=r.current[t];if(!n)return;let a=n.getContext("2d");a&&(s.current[t]=new D.t1(a,{type:e.chartType,data:e.data,options:e.options||{}}))}),()=>{s.current.forEach(e=>null==e?void 0:e.destroy())}),[t]);let l=e=>{let t=e.data.datasets;return t.length>0&&t.some(e=>e.data&&e.data.length>0)},i=t.filter(l);if(0===i.length)return(0,n.jsx)("div",{className:"flex items-center justify-center h-64 bg-gray-50 rounded-lg border border-gray-200",children:(0,n.jsx)("p",{className:"text-gray-500",children:"No charts found in this Excel file"})});if(1===i.length){let e=i[0];return(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:e.title||"Excel Chart"}),(0,n.jsx)("div",{className:"relative h-96",children:(0,n.jsx)("canvas",{ref:e=>{r.current[0]=e}})})]})}return(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,n.jsx)("div",{className:"border-b border-gray-300 bg-gray-100 px-2 py-1",children:(0,n.jsx)("div",{className:"flex gap-0.5 overflow-x-auto overflow-y-hidden",children:i.map((e,t)=>(0,n.jsx)("button",{onClick:()=>o(t),className:"px-4 py-1.5 text-sm font-medium transition-colors flex-shrink-0 ".concat(a===t?"bg-white text-gray-900 border border-gray-300 relative -mb-[1px] z-10":"bg-gray-50 text-gray-600 border border-gray-300 hover:bg-gray-100 hover:text-gray-800"),style:{borderTopLeftRadius:"6px",borderTopRightRadius:"6px",borderBottom:a===t?"1px solid white":void 0,minWidth:"100px",maxWidth:"200px"},children:(0,n.jsxs)("div",{className:"truncate",children:[(0,n.jsx)("div",{children:e.title||"Chart ".concat(t+1)}),e.sheetName&&(0,n.jsx)("div",{className:"text-xs text-gray-500 font-normal",children:e.sheetName})]})},e.id))})}),(0,n.jsx)("div",{className:"p-4",children:i.map((e,t)=>(0,n.jsx)("div",{className:a===t?"block":"hidden",children:(0,n.jsx)("div",{className:"relative h-96",children:(0,n.jsx)("canvas",{ref:e=>{r.current[t]=e}})})},e.id))})]})}function el(e){let{content:t}=e,[r,s]=(0,h.useState)([]),[a,o]=(0,h.useState)(0),[l,i]=(0,h.useState)(!0),[c,d]=(0,h.useState)(null),[u,m]=(0,h.useState)(null);if((0,h.useEffect)(()=>{(async()=>{try{i(!0),await (0,ea.k0)(es.A.xlsx);let e=window.XLSX;if(!e)throw Error("XLSX library not available");let r=new Uint8Array(t).reduce((e,t)=>e+String.fromCharCode(t),""),n=e.read(r,{type:"binary",cellFormula:!0,cellStyles:!0,sheetStubs:!0,raw:!1}),a=[];n.SheetNames.forEach(t=>{let r=n.Sheets[t];if(!r["!ref"])return void a.push({name:t,data:[]});let s=e.utils.decode_range(r["!ref"]),o=[];for(let t=0;t<=s.e.r;t++){let n=[];for(let a=0;a<=s.e.c;a++){let s=r[e.utils.encode_cell({r:t,c:a})];if(s){let e=null;null!==s.v&&void 0!==s.v&&""!==s.v&&(e="number"==typeof s.v?Number.isInteger(s.v)?s.v.toString():s.v.toFixed(2):String(s.v)),n.push({value:e,formula:s.f})}else n.push(null)}o.push(n)}a.push({name:t,data:o})}),s(a),d(null)}catch(e){d(e instanceof Error?e.message:"Failed to load Excel file")}finally{i(!1)}})()},[t]),l)return(0,n.jsx)("div",{className:"flex items-center justify-center min-h-[600px]",children:(0,n.jsx)(O.k,{size:"md"})});if(c)return(0,n.jsx)("div",{className:"flex items-center justify-center min-h-[600px] bg-red-50 rounded-lg p-8",children:(0,n.jsxs)("div",{className:"text-center max-w-md",children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Failed to Load Excel File"}),(0,n.jsx)("p",{className:"text-red-700",children:c})]})});let f=r[a];return(null==f?void 0:f.data.length)?(0,n.jsxs)("div",{className:"h-full flex flex-col bg-gray-50",children:[(0,n.jsx)(q,{sheetName:f.name,data:f.data,selectedCell:u,onCellSelect:m,formulaBar:!0}),r.length>1&&(0,n.jsx)("div",{className:"flex-shrink-0 border-t border-gray-300 bg-gray-100 px-2 py-1",children:(0,n.jsx)("div",{className:"flex gap-0.5 overflow-x-auto overflow-y-hidden scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200",children:r.map((e,t)=>(0,n.jsx)("button",{className:"px-4 py-1.5 text-sm font-medium transition-colors flex-shrink-0 truncate ".concat(t===a?"bg-white text-gray-900 border border-gray-300 relative -mb-[1px] z-10":"bg-gray-50 text-gray-600 border border-gray-300 hover:bg-gray-100 hover:text-gray-800"),style:{borderTopLeftRadius:"6px",borderTopRightRadius:"6px",borderBottom:t===a?"1px solid white":void 0,minWidth:"80px",maxWidth:"150px"},onClick:()=>o(t),title:e.name,disabled:1===r.length,children:(0,n.jsx)("span",{className:"block truncate",children:e.name})},t))})})]}):(0,n.jsx)("div",{className:"flex items-center justify-center min-h-[600px] bg-gray-50 rounded-lg",children:(0,n.jsx)("p",{className:"text-gray-500",children:"No data available in this Excel file"})})}function ei(e){let{content:t}=e,[r,s]=(0,h.useState)(null),[a,o]=(0,h.useState)([]),[l,i]=(0,h.useState)(!1),[c,d]=(0,h.useState)("data");return((0,h.useEffect)(()=>{!async function(){try{i(!0);let e=await G(t),r=e.charts.filter(e=>{let t=e.data.datasets;return t.length>0&&t.some(e=>e.data&&e.data.length>0)});e.hasCharts&&r.length>0?(s(!0),o(r)):s(!1)}catch(e){s(!1)}finally{i(!1)}}()},[t]),r)?(0,n.jsxs)("div",{className:"h-full flex flex-col pt-12",children:[(0,n.jsx)("div",{className:"border-b border-gray-200 bg-white",children:(0,n.jsxs)("nav",{className:"flex -mb-px",children:[(0,n.jsxs)("button",{onClick:()=>d("data"),className:"group inline-flex items-center px-6 py-3 border-b-2 font-medium text-sm transition-colors ".concat("data"===c?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,n.jsx)(I.Wm,{className:"-ml-0.5 mr-2 h-4 w-4 ".concat("data"===c?"text-blue-500":"text-gray-400")}),"Data"]}),(0,n.jsxs)("button",{onClick:()=>d("charts"),className:"group inline-flex items-center px-6 py-3 border-b-2 font-medium text-sm transition-colors ".concat("charts"===c?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,n.jsx)(I.t1,{className:"-ml-0.5 mr-2 h-4 w-4 ".concat("charts"===c?"text-blue-500":"text-gray-400")}),"Charts",a.length>0&&(0,n.jsx)("span",{className:"ml-2 rounded-full px-2 py-0.5 text-xs ".concat("charts"===c?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"),children:a.length})]})]})}),(0,n.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:"data"===c?(0,n.jsx)(el,{content:t}):(0,n.jsx)("div",{className:"h-full overflow-auto bg-gray-50 p-4",children:l?(0,n.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,n.jsx)(O.k,{size:"sm"})}):(0,n.jsx)(eo,{charts:a})})})]}):(0,n.jsx)("div",{className:"h-full flex flex-col pt-12",children:(0,n.jsx)(el,{content:t})})}D.t1.register(...D.$L);var ec=r(20965),ed=r(74023),eu=r(12247);let em=(0,eu.createServerReference)("60f1aea5f9f8fd439e2e72edc42ffeb8de55f6bf03",eu.callServer,void 0,eu.findSourceMapURL,"convertDocumentToPdf"),eh=4,ef=500;function ep(e){let{page:t,pageNumber:r,totalPages:s,containerWidth:a,isInitialPage:o}=e,l=(0,h.useRef)(null),[i,c]=(0,h.useState)(!1),[d,u]=(0,h.useState)(null),[m,f]=(0,h.useState)(0),{viewport:p,displayHeight:g,displayWidth:y}=(0,h.useMemo)(()=>{try{let e=t.getViewport({scale:1}),r=a/e.width*(window.devicePixelRatio||1),n=t.getViewport({scale:r});return{viewport:n,displayHeight:a*n.height/n.width,displayWidth:a}}catch(e){return{viewport:t.getViewport({scale:1}),displayHeight:800,displayWidth:a}}},[t,a]);return(0,h.useEffect)(()=>{let e=()=>{!document.hidden&&i&&null===d&&f(e=>e+1)};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[i,d]),(0,h.useEffect)(()=>{let e=l.current;if(!e)return;let n=async()=>{try{e.width=p.width,e.height=p.height;let r=e.getContext("2d");if(!r)return void u("Unable to display page");let n=t.render({canvasContext:r,viewport:p});await n.promise,c(!0),u(null)}catch(e){u("Unable to display page")}};c(!1),u(null);let s=setTimeout(()=>void n(),o?10:(r-eh+1)*100);return()=>clearTimeout(s)},[t,p,r,o,m]),(0,n.jsxs)("div",{className:"relative bg-white shadow-lg w-full max-w-full",id:"page-".concat(r),children:[!i&&!d&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50",children:(0,n.jsxs)("div",{className:"text-gray-400",children:["Loading page ",r,"..."]})}),d&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-red-50",children:(0,n.jsxs)("div",{className:"text-red-600",children:["Unable to display page ",r]})}),(0,n.jsx)("canvas",{ref:l,style:{width:"".concat(y,"px"),height:"".concat(g,"px"),maxWidth:"100%"}}),(0,n.jsxs)("div",{className:"absolute bottom-2 right-2 bg-black bg-opacity-50 text-white px-2 py-1 text-sm rounded",children:["Page ",r," / ",s]})]})}let eg=null;function ey(e){let{content:t,skipInitialLoading:r=!1}=e,s=(0,h.useRef)(null),[a,o]=(0,h.useState)(null),[l,i]=(0,h.useState)(!r),[c,d]=(0,h.useState)(null),[u,m]=(0,h.useState)([]),[f,p]=(0,h.useState)(0),g=(0,h.useRef)(null);(0,h.useEffect)(()=>{if(!t)return;let e=!1,n=null;return(async()=>{try{r||i(!0),o(null);let s=new Uint8Array(t);window.pdfjsLib||(eg||(eg=new Promise((e,t)=>{let r=document.createElement("script");r.src="/libs/pdf.min.js",r.async=!0,r.onload=()=>{let t=window.pdfjsLib;t.GlobalWorkerOptions&&(t.GlobalWorkerOptions.workerSrc="/libs/pdf.worker.min.js"),e()},r.onerror=()=>{eg=null,t(Error("Unable to load PDF viewer"))},document.head.appendChild(r)})),await eg);let a=window.pdfjsLib.getDocument({data:s.slice(),standardFontDataUrl:"/libs/standard_fonts/"}),l=new Promise((e,t)=>{setTimeout(()=>t(Error("PDF loading timeout")),3e4)});if(n=await Promise.race([a.promise,l]),e)return void n.destroy();e||d(n);let c=[];for(let e=1;e<=n.numPages;e++)c.push(n.getPage(e));let u=await Promise.all(c);e||(m(u),i(!1))}catch(t){e||(o("Unable to load PDF file"),i(!1))}})(),()=>{e=!0,n&&n.destroy()}},[t,r]),(0,h.useEffect)(()=>()=>{c&&c.destroy()},[c]),(0,h.useEffect)(()=>{let e=s.current;if(!e)return;let t=()=>{let t=window.getComputedStyle(e),r=parseFloat(t.paddingLeft)||0,n=parseFloat(t.paddingRight)||0;p(e.clientWidth-r-n)};t();let r=new ResizeObserver(()=>{g.current&&clearTimeout(g.current),g.current=setTimeout(t,ef)});return r.observe(e),()=>{r.disconnect(),g.current&&clearTimeout(g.current)}},[]);let y=(0,h.useMemo)(()=>c&&0!==f?u.map((e,t)=>(0,n.jsx)(ep,{page:e,pageNumber:t+1,totalPages:c.numPages,containerWidth:f,isInitialPage:t<eh},t+1)):null,[u,c,f]);return a?(0,n.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-50",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-red-500 mb-2 font-medium",children:a}),(0,n.jsx)("div",{className:"text-sm text-gray-500",children:"The PDF file may be corrupted or invalid."})]})}):(0,n.jsxs)("div",{className:"h-full w-full bg-gray-100",children:[l&&(0,n.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,n.jsx)(O.k,{size:"md"})}),(0,n.jsx)("div",{ref:s,className:"h-full w-full overflow-auto p-4 ".concat(l?"hidden":""),id:"artifacts-component-root-pdf",children:f>0&&(0,n.jsx)("div",{className:"space-y-4 flex flex-col items-center",children:y})})]})}let ex=50,eb=1048576,ew=0x3200000;async function ev(e){return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",e))).map(e=>e.toString(16).padStart(2,"0")).join("")}async function eE(e,t){let r=await em(e,t);if(!r.success||!r.data)throw Error(r.error||"Document conversion failed");return r.data}function eS(e){let{content:t,mimeType:r}=e,[s,a]=(0,h.useState)(null);(0,h.useEffect)(()=>{let e=!1;return a(null),ev(t).then(t=>{e||a(t)}),()=>{e=!0}},[t]);let o=(0,h.useMemo)(()=>{if(!t)return"Document content is required";let e=t.byteLength;return e>ew?"Document size (".concat(Math.floor(e/eb),"MB) exceeds maximum allowed size of ").concat(ex,"MB"):null},[t]),{data:l,error:i,isLoading:c}=(0,ed.I)({queryKey:["office-document-conversion",s,r,t],queryFn:()=>eE(t,r),enabled:!o&&null!==s,retry:!1}),d=(0,h.useMemo)(()=>o?o:i?i instanceof TypeError&&i.message.includes("fetch")?"Unable to load document. Please check your network connection.":i instanceof Error?i.message:"Unable to preview this document. The file may be corrupted or in an unsupported format.":null,[o,i]);return d?(0,n.jsx)("div",{className:"flex items-center justify-center min-h-[600px] bg-danger-900 rounded-lg p-8",children:(0,n.jsxs)("div",{className:"text-center max-w-md",children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-danger-100 mb-2",children:"Failed to Load Document"}),(0,n.jsx)("p",{className:"text-danger-200",children:d})]})}):l?(0,n.jsx)(ey,{content:l,skipInitialLoading:!0}):c?(0,n.jsx)("div",{className:"flex items-center justify-center h-full min-h-[400px]",children:(0,n.jsx)(O.k,{size:"md"})}):null}let ej=(0,h.memo)(eS);var eR=r(54977),eC=r(37965),eN=r(34303),eT=r(50882);function eM(e){let{contentType:t,textContent:r,binaryContent:s,htmlRendererRef:a,handleScreenshot:o,handleError:l,tailwindStylesEnabled:i,sendRequest:c}=e;switch(t){case y.vU.Html:return(0,n.jsx)(eN.r,{content:r,ref:a,onScreenshot:o});case y.vU.Svg:return(0,n.jsx)(eT.c,{content:r});case y.vU.Mermaid:return(0,n.jsx)(ec.Z,{content:r});case y.vU.React:return(0,n.jsx)(eR.N,{content:r,handleError:l,tailwindStylesEnabled:i});case y.qK.Pdf:if(s)return(0,n.jsx)(ey,{content:s});return null;case y.qK.Csv:return(0,n.jsx)(F,{content:r,delimiter:y.Yc.Comma});case y.qK.Tsv:return(0,n.jsx)(F,{content:r,delimiter:y.Yc.Tab});case y.pW.Repl:return(0,n.jsx)(eC.b,{initialCode:r,sendRequest:c});default:if((0,y.EJ)(t)&&s)return(0,n.jsx)(ej,{content:s,mimeType:t});if((0,y.$1)(t)&&s)return(0,n.jsx)(ei,{content:s});return null}}var eA=r(73439),ek=r(7391),eq=r(6845),eL=r(5239);let eP=e=>{let{title:t,description:r,subtext:s,inset:a,cta:o,onClick:l,ctaDisabled:i,insetStyle:c="default"}=e,d=()=>a?Array.isArray(a)?(0,n.jsx)("ul",{children:a.map((e,t)=>(0,n.jsx)("li",{children:e},t))}):a:null;return(0,n.jsxs)(eL.Card,{className:"border-gray-200 w-[460px] max-w-full shadow-lg bg-bg-000",children:[(0,n.jsxs)(eL.CardHeader,{className:"flex-row items-center space-y-0",children:[(0,n.jsx)(ek.A,{className:"mr-2 h-5 w-5"}),(0,n.jsx)(eL.CardTitle,{children:t})]}),(0,n.jsxs)(eL.CardContent,{children:[(0,n.jsx)("p",{className:"mb-2 text-sm",children:r}),!!a&&(0,n.jsx)("div",{className:(0,eA.A)("flex flex-col rounded-md bg-gray-100 p-2 font-mono text-xs","danger"===c&&"text-destructive"),children:d()}),!!s&&(0,n.jsx)("p",{className:"text-text-500 mt-2 text-sm",children:s}),!!o&&(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)(eq.Button,{className:"mt-4",onClick:l,disabled:i,children:o})})]})]})};var eF=r(73462);let eI=e=>(0,eF.pd)(e,{transforms:["jsx","typescript","imports"],production:!0}).code.substring(13);function eD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4,r=(0,ea.r1)(e),n=window.location.origin,a=r.map(e=>{var t;let r=new URL(null==(t=es.A[e])?void 0:t.path,n).href;return"importScripts('".concat(r,"');")}).join("\n");return new Promise(n=>{var o,l;let i="\n      // For each library, import it.\n      ".concat(a,"\n\n      const dependencies = {\n        ").concat(r.map(e=>{var t;return"".concat(e,": ").concat(null==(t=es.A[e])?void 0:t.global)}).join(",\n  "),"\n      };\n\n      const mockRequire = (moduleName) => {\n        if (dependencies[moduleName]) {\n          return dependencies[moduleName];\n        }\n        throw new Error(`Module not found: '${moduleName}'`);\n      };\n\n      let pendingPromises = new Set();\n      let pendingTimers = new Set();\n\n      const originalPromise = Promise;\n      self.Promise = function (...args) {\n        const promise = new originalPromise(...args);\n        pendingPromises.add(promise);\n        promise.then(() => pendingPromises.delete(promise), () => pendingPromises.delete(promise));\n        return promise;\n      };\n\n      // Maintain static methods of Promise\n      Object.getOwnPropertyNames(originalPromise).forEach(prop => {\n        if (prop !== 'prototype' && typeof originalPromise[prop] === 'function') {\n          self.Promise[prop] = function(...args) {\n            const result = originalPromise[prop].apply(originalPromise, args);\n            if (result instanceof originalPromise) {\n              pendingPromises.add(result);\n              result.then(() => pendingPromises.delete(result), () => pendingPromises.delete(result));\n            }\n            return result;\n          };\n        }\n      });\n\n      const originalSetTimeout = self.setTimeout;\n      self.setTimeout = function (callback, delay, ...args) {\n        const timer = originalSetTimeout(() => {\n          pendingTimers.delete(timer);\n          callback(...args);\n        }, delay);\n        pendingTimers.add(timer);\n        return timer;\n      };\n\n      function waitForAsync() {\n        return new originalPromise(resolve => {\n          function check() {\n            if (pendingPromises.size === 0 && pendingTimers.size === 0) {\n              resolve();\n            } else {\n              originalSetTimeout(check, 0);\n            }\n          }\n          check();\n        });\n      }\n\n      const stringifyArg = (arg) => {\n        if (typeof arg === 'object' && arg !== null) {\n          try {\n            return JSON.stringify(arg);\n          } catch (error) {\n            return '[Unstringifiable Value]';\n          }\n        }\n        return String(arg);\n      };\n\n      const logs = [];\n      const originalConsole = console;\n      console = {\n        log: (...args) => {\n          const stringifiedArgs = args.map(stringifyArg);\n          logs.push(stringifiedArgs.join(' '));\n        },\n        warn: (...args) => {\n          const stringifiedArgs = args.map(stringifyArg);\n          logs.push('WARN: ' + stringifiedArgs.join(' '));\n        },\n        error: (...args) => {\n          const stringifiedArgs = args.map(stringifyArg);\n          logs.push('ERROR: ' + stringifiedArgs.join(' '));\n        }\n      };\n\n\n      // In case of multiple files, use a map\n      let requestId = 0;\n      const callbacksMap = new Map();\n      \n      // Override global fetch\n      self.fetch = (url, init = {}) => {\n        return new Promise((resolve, reject) => {\n          const id = requestId++;\n          callbacksMap.set(id, { resolve, reject });\n          self.postMessage({\n            type: 'proxyFetch',\n            id,\n            url,\n            init,\n          });\n        });\n      };\n      \n      self.window = {\n        fs: {\n          readFile: async (filename, encoding) => {\n            return new Promise((resolve, reject) => {\n              const id = requestId++;\n              callbacksMap.set(id, { resolve, reject });\n              self.postMessage({ type: 'readFile', id, filename, encoding});\n            });\n          }\n        },\n        claude: {\n          complete: async (prompt) => {\n            return new Promise((resolve, reject) => {\n              const id = requestId++;\n              callbacksMap.set(id, { resolve, reject });\n              self.postMessage({ type: 'claudeComplete', id, prompt });\n            });\n          }\n        }\n      }\n\n      self.onmessage = async function(e) {\n        // Handle capability responses\n        if (e.data.type === 'fileContent') {\n          const callback = callbacksMap.get(e.data.id);\n          callback.resolve(e.data.content);\n          await waitForAsync();\n          callbacksMap.delete(e.data.id);\n          return;\n        } else if (e.data.type === 'fileError') {\n          const callback = callbacksMap.get(e.data.id);\n          callback.reject(new Error(e.data.error));\n          callbacksMap.delete(e.data.id);\n          return;\n        } else if (e.data.type === 'claudeComplete') {\n          const callback = callbacksMap.get(e.data.id);\n          if (e.data.error) {\n            callback.reject(new Error(e.data.error));\n          } else {\n            callback.resolve(e.data.completion);\n          }\n          callbacksMap.delete(e.data.id);\n          return;\n        } else if (e.data.type === 'proxyFetchResponse') {\n          const callback = callbacksMap.get(e.data.id);\n          if (e.data.error) {\n            callback.reject(new Error(e.data.error));\n          } else {\n            callback.resolve(new Response(e.data.body, {\n              status: e.data.status,\n              statusText: e.data.statusText,\n              headers: e.data.headers\n            }));\n          }\n          callbacksMap.delete(e.data.id);\n          return;\n        } \n\n        // Handle code execution\n        const code = e.data;\n        const wrappedCode = `\n          return (async ({ require }) => {\n            ${code}\n          });\n        `;\n\n        try {\n          const fn = new Function(wrappedCode);\n          const result = await fn()({ require: mockRequire });\n          await waitForAsync();\n          self.postMessage({ status: 'success', result: JSON.stringify(result), logs });\n        } catch (error) {\n          self.postMessage({\n            status: 'error',\n            error: error instanceof Error ? error.message : String(error),\n            logs\n          });\n        }\n      };\n    "),c=new Worker((null==(o=(l=window).originalCreateObjectUrl)?void 0:o.call(l,new Blob([i],{type:"application/javascript"})))||""),d=setTimeout(()=>{c.terminate(),n({status:"error",logs:[],error:"Execution timed out"})},t);c.onmessage=async e=>{var t,r,a,o,l,i;if((null==(t=e.data)?void 0:t.type)==="readFile")try{let t=await window.fs.readFile(null==(o=e.data)?void 0:o.filename,null==(l=e.data)?void 0:l.encoding);c.postMessage({type:"fileContent",content:t,id:null==(i=e.data)?void 0:i.id})}catch(e){n({status:"error",logs:[],error:e instanceof Error?e.message:String(e)}),c.terminate()}else if((null==(r=e.data)?void 0:r.type)==="claudeComplete")try{let t=await window.claude.complete(e.data.prompt);c.postMessage({type:"claudeComplete",completion:t,id:e.data.id})}catch(t){c.postMessage({type:"claudeComplete",error:t instanceof Error?t.message:String(t),id:e.data.id})}else if((null==(a=e.data)?void 0:a.type)==="proxyFetch")try{let t=await fetch(e.data.url,e.data.init);t.body?c.postMessage({type:"proxyFetchResponse",id:e.data.id,headers:Object.fromEntries(t.headers.entries()),status:t.status,statusText:t.statusText,body:t.body},[t.body]):c.postMessage({type:"proxyFetchResponse",id:e.data.id,headers:Object.fromEntries(t.headers.entries()),status:t.status,statusText:t.statusText})}catch(t){c.postMessage({type:"proxyFetchResponse",id:e.data.id,error:t instanceof Error?t.message:String(t)})}else{clearTimeout(d),c.terminate();let t=s.Ub.safeParse(e.data);t.success?n(t.data):n({status:"error",logs:[],error:"Invalid execution result: "+t.error.message})}},c.postMessage(eI(e))})}let eO=e=>{let{sendRequest:t,handleError:r}=e;(0,h.useEffect)(()=>{let e=void 0===t?async(e,t)=>Promise.resolve(null):async(e,n)=>{try{let r=await t(s.uZ.GetFile,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.GetFileRequest",key:e});if("type.googleapis.com/anthropic.claude.usercontent.sandbox.GetFileResponse"!==r["@type"])throw Error("Unexpected response type");let a=r.value;if(null===a)throw Error('File not found: No file named "'.concat(e,'"'));let o=(null==n?void 0:n.encoding)||null;if("utf8"===o||"utf-8"===o||"utf_8"===o)return new TextDecoder("utf-8").decode(a);if("binary"===o||null===o)return a;throw Error("Unsupported encoding: ".concat(o))}catch(t){throw t instanceof Error?t.message.startsWith("File not found:")?r({type:"FileNotFound",fileName:e}):r({type:"RuntimeError",message:t.message}):r({type:"RuntimeError",message:String(t)}),t}},n=(e,t)=>{throw Error("Synchronous file operations are not supported in this environment. Please use readFile instead.")},a=void 0===t?async e=>Promise.resolve(""):async e=>{try{var n;let r=await t(s.uZ.ClaudeCompletion,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.ClaudeCompletionRequest",prompt:e});if("type.googleapis.com/anthropic.claude.usercontent.sandbox.ClaudeCompletionResponse"!==r["@type"])throw Error("Unexpected response type");return null!=(n=r.completion)?n:""}catch(e){return r({type:"ClaudeCompletionError",message:e instanceof Error?e.message:String(e)}),""}},o=e=>{null==t||t(s.uZ.SendConversationMessage,{messageType:"text",message:e,"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.SendConversationMessageRequest"})},l=e=>{null==t||t(s.uZ.OpenExternal,{href:e,"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.OpenExternal"})},i=void 0===t?async(e,t)=>Promise.resolve(null):async function(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{let n=await t(s.uZ.StorageGet,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.StorageGetRequest",key:e,shared:r});if(n&&"type.googleapis.com/anthropic.claude.usercontent.sandbox.StorageGetResponse"!==n["@type"])throw Error("Unexpected response type");return null!=n?n:null}catch(e){throw Error("Storage get failed: ".concat(e instanceof Error?e.message:String(e)))}},c=void 0===t?async(e,t,r)=>Promise.resolve({key:"",value:"",shared:!1}):async function(e,r){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{let a=await t(s.uZ.StorageSet,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.StorageSetRequest",key:e,value:r,shared:n});if("type.googleapis.com/anthropic.claude.usercontent.sandbox.StorageSetResponse"!==a["@type"])throw Error("Unexpected response type");return a}catch(e){throw Error("Storage set failed: ".concat(e instanceof Error?e.message:String(e)))}},d=void 0===t?async(e,t)=>Promise.resolve({key:"",deleted:!1,shared:!1}):async function(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{let n=await t(s.uZ.StorageDelete,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.StorageDeleteRequest",key:e,shared:r});if("type.googleapis.com/anthropic.claude.usercontent.sandbox.StorageDeleteResponse"!==n["@type"])throw Error("Unexpected response type");return n}catch(e){throw Error("Storage delete failed: ".concat(e instanceof Error?e.message:String(e)))}},u=void 0===t?async(e,t)=>Promise.resolve({keys:[],prefix:null,shared:!1}):async function(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{let n=await t(s.uZ.StorageList,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.StorageListRequest",prefix:e,shared:r});if("type.googleapis.com/anthropic.claude.usercontent.sandbox.StorageListResponse"!==n["@type"])throw Error("Unexpected response type");return n}catch(e){throw Error("Storage list failed: ".concat(e instanceof Error?e.message:String(e)))}},m=e=>{null==t||t(s.uZ.DownloadFile,{filename:e.filename,data:e.data,mimeType:e.mimeType,"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.DownloadFile"})};window.fs={readFile:e,readFileSync:n},window.claude={complete:a,sendConversationMessage:o,openExternal:l,downloadFile:m},window.storage={get:i,set:c,delete:d,list:u},window.open=e=>(e&&l(e.toString()),null)},[t,r])},eU={rootSelectors:["#artifacts-component-root-svg","#artifacts-component-root-react","#mermaid",".research-report-content"]},eW=["hover","focus","active","visited","focus-within","focus-visible","disabled","checked","indeterminate","required","optional","valid","invalid","in-range","out-of-range","read-only","read-write","placeholder-shown","default","empty","enabled","first-child","last-child","only-child","first-of-type","last-of-type","only-of-type","nth-child\\([^)]+\\)","nth-last-child\\([^)]+\\)","nth-of-type\\([^)]+\\)","nth-last-of-type\\([^)]+\\)","target","root","before","after","first-letter","first-line","selection","backdrop"],eB=RegExp(":(?:".concat(eW.join("|"),")"),"g");function ez(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,r=[],n=new Set,s=[e,...Array.from(e.querySelectorAll("*"))],a=new Set,o=new Set,l=new Set,i=e=>{try{let t=e.replace(eB,"");return s.some(r=>{try{return r.matches(t)||r.matches(e)}catch(e){return!1}})}catch(e){return!1}};for(let e of(s.forEach(e=>{var r;let n=null==(r=t.defaultView)?void 0:r.getComputedStyle(e);if(n){for(let e=0;e<n.length;e++)for(let t of n.getPropertyValue(n[e]).matchAll(/var\(([^)]+)\)/g)){let e=t[1].split(",")[0].trim();a.add(e)}let e=n.fontFamily;e&&(e.match(/("([^"]+)"|'([^']+)'|([^,]+))/g)||[]).forEach(e=>{let t=e.trim().replace(/^["']|["']$/g,"");o.add(t)});let t=n.animationName;t&&"none"!==t&&t.split(",").forEach(e=>{let t=e.trim();t&&"none"!==t&&l.add(t)})}}),t.styleSheets))try{if(n.has(e)||(n.add(e),e.href&&!e.href.includes(window.location.origin)))continue;if(e.href)for(let t of Array.from(e.cssRules||[]))e_(t,i,a,o,l)&&r.push(eV(t));else for(let t of Array.from(e.cssRules||[]))r.push(eV(t))}catch(e){}return r.join("\n")}function e_(e,t,r,n,s){let a=e.constructor.name;if("CSSStyleRule"===a){let n=e;if(t(n.selectorText)||":root"===n.selectorText&&n.cssText.includes("--")||Array.from(n.style).some(e=>e.startsWith("--")&&r.has(e)))return!0}else if("CSSMediaRule"===a||"CSSSupportsRule"===a)return!0;else if("CSSKeyframesRule"===a)return s.has(e.name);else if("CSSFontFaceRule"===a){var o,l,i,c;let t=e,r=(null==(l=t.style)||null==(o=l.fontFamily)?void 0:o.replace(/["']/g,"").trim())||(null==(c=t.cssText.match(/font-family:\s*["']?([^"';}\n]+)["']?/i))||null==(i=c[1])?void 0:i.trim());if(r&&Array.from(n).some(e=>e.toLowerCase()===r.toLowerCase()))return!0}return!1}let eZ={[Node.TEXT_NODE]:(e,t)=>t.createTextNode(e.textContent||""),[Node.ELEMENT_NODE]:(e,t)=>{let r=e,n=t.createElement(r.tagName.toLowerCase());for(let e of r.attributes)n.setAttribute(e.name,e.value);if("canvas"===r.tagName.toLowerCase())try{let e=r,n=e.toDataURL("image/png");if(n&&"data:,"!==n){let r=t.createElement("img");return r.src=n,r.width=e.width,r.height=e.height,r.className=e.className,e.style.cssText&&(r.style.cssText=e.style.cssText),r}}catch(e){}for(let e of r.childNodes){let r=eZ[e.nodeType];if(r){let s=r(e,t);s&&n.appendChild(s)}}return n}},eH=(e,t)=>(0,eZ[Node.ELEMENT_NODE])(e,t);function eG(e){let t=e.selectorText.split(",").map(e=>"body"===(e=e.trim())?".snapshot-body":"html"===e?".snapshot-frame":e.startsWith("@")||e.includes(".snapshot-")?e:".snapshot-body ".concat(e)).join(", "),r=e.style.cssText.replace(/100vh/g,"100%").replace(/100vw/g,"100%");return"".concat(t," { ").concat(r," }")}function eV(e){let t=e.constructor.name;if("CSSStyleRule"===t)return eG(e);if("CSSMediaRule"!==t&&"CSSSupportsRule"!==t)return e.cssText;{let r=Array.from(e.cssRules).map(eV),n="CSSMediaRule"===t?"@media ".concat(e.conditionText):"@supports ".concat(e.conditionText);return"".concat(n," {\n").concat(r.join("\n"),"\n}")}}function eK(e){let t=null,r=document;if("text/html"===e){let e=document.querySelector("iframe");if(!(null==e?void 0:e.contentDocument))return null;t=e.contentDocument.body,r=e.contentDocument}else{let e=null;for(let t of eU.rootSelectors)if(e=document.querySelector(t))break;if(!e)return null;t=e}let n=ez(t,r),s=".snapshot-body { position: absolute; inset: 0; }",a="<style>\n".concat(s,"\n").concat(n||"","\n</style>"),o=eH(t,document.implementation.createHTMLDocument());return a+'<div class="snapshot-body">'.concat(o.outerHTML,"</div>")}async function e$(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;return Promise.race([new Promise(e=>setTimeout(()=>{e(null)},t)),new Promise(t=>{setTimeout(()=>{try{let r=eK(e);t(r)}catch(e){t(null)}},0)})])}function eX(){try{return window.self!==window.top}catch(e){return!0}}function eJ(){let{defaultParentOrigin:e}=(0,E.t)();return(0,h.useCallback)(()=>{if(window.top)try{window.top.location.href="//".concat(e);return}catch(e){}window.location.href="//".concat(e)},[e])}function eQ(e){let{error:t}=e,r=g(t);return(0,n.jsx)("div",{className:"flex min-h-full w-full items-center justify-center bg-gray-100 p-4",children:(0,n.jsx)(eP,{title:r.title,description:r.description,inset:r.inset,subtext:r.subtext,insetStyle:r.insetStyle})})}function eY(){let{allowedParents:e}=(0,E.t)(),t=eJ(),[r,a]=(0,h.useState)(""),[o,l]=(0,h.useState)(null),[i,d]=(0,h.useState)(),[u,f]=(0,h.useState)(!1),[g,j]=(0,h.useState)(!1),[R,C]=(0,h.useState)(null),[N,T]=(0,h.useState)(!1),M=(0,h.useRef)(null),A=(0,h.useRef)(null),k=(0,h.useRef)(null),q=(0,h.useMemo)(()=>e.map(e=>"".concat(e.scheme,"://").concat(e.origin)),[e]),L=(0,h.useCallback)(()=>{M.current&&(clearTimeout(M.current),M.current=null),T(!1)},[]),P=(0,h.useCallback)(e=>{k.current&&(k.current(e),k.current=null)},[]),F=()=>Array.from(document.querySelectorAll(".research-report-content")).map(e=>e.outerHTML).join(""),I=(0,h.useCallback)(async e=>{var t,r,n,o;let{method:u,payload:m}=e;if(L(),u===s.uZ.SetContent){C(null),m.content instanceof ArrayBuffer?(l(m.content),a("")):(a(m.content),l(null)),d(m.type),j(null!=(t=m.tailwindStylesEnabled)&&t),f(null!=(r=m.watchContentSize)&&r);return}if(u===s.uZ.RunCode)try{let e=await eD(m.code);return{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.RunCodeResponse",...e}}catch(e){return{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.RunCodeResponse",status:"error",logs:[],error:"Unexpected error executing code: "+(e instanceof Error?e.message:String(e))}}if(u===s.uZ.GetScreenshot){if(i===y.vU.Html){let e=new Promise(e=>{k.current=e});null==(o=A.current)||null==(n=o.contentWindow)||n.postMessage({type:"takeScreenshot"},"*");let t=await e;return{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.GetScreenshotResponse",screenshot:t.success?t.screenshot:null}}let e=document.getElementById("artifacts-component-root-svg")||document.getElementById("artifacts-component-root-react")||document.getElementById("mermaid");return e?{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.GetScreenshotResponse",screenshot:await (0,b.$E)(e,{imagePlaceholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAA1JREFUGFdjePDgwX8ACOQDoNsk0PMAAAAASUVORK5CYII="})}:{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.GetScreenshotResponse",screenshot:null}}if(u===s.uZ.CopyHtmlContent)return{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.CopyHtmlContentResponse",reportHTMLContent:F()};if(u===s.uZ.ProxyFetchStream){let{channelId:e,chunk:t,done:r,error:n}=m;c(e,t,r,n);return}else if(u===s.uZ.GetDOMSnapshot)return{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.GetDOMSnapshotResponse",domSnapshot:await e$(i||"")}},[L,i]),{sendRequest:D}=p({parentWindow:window.parent,allowedOrigins:q,onOutsideRequest:I});(0,h.useEffect)(()=>{if(!D||!r&&!o||!i)return;let e=()=>{D(s.uZ.DOMContentLoaded,{"@type":"type.googleapis.com/google.protobuf.Empty"})},t=()=>{setTimeout(e,2e3)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t,{once:!0}):t()},[D,r,o,i]);let U="parent"===(0,v.useSearchParams)().get("errorReportingMode")?"parent":"sandbox",W=(0,h.useCallback)(e=>{"parent"===U&&e?null==D||D(s.uZ.ReportError,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.ReportErrorRequest",error:e}):C(e)},[U,D]);eO({sendRequest:D,handleError:W}),(0,h.useEffect)(()=>{eX()||t()},[t]),(0,h.useEffect)(()=>{if(!D)return;let e=!0,t=0,r=20;return async function(){for(;e&&t<r;)try{let t=await Promise.race([null==D?void 0:D(s.uZ.ReadyForContent,{"@type":"type.googleapis.com/google.protobuf.Empty"}),new Promise((e,t)=>setTimeout(()=>t(Error("Timeout")),200))]);return e=!1,t}catch(e){++t>=r&&x.v.warn(x.u.USER_CONTENT_RENDERER,"Max retries reached while trying to send ready message",e),await new Promise(e=>setTimeout(e,500))}}(),()=>{e=!1}},[D]),(0,h.useEffect)(()=>(L(),M.current=setTimeout(()=>{T(!0)},3e3),()=>{M.current&&clearTimeout(M.current)}),[r,o,i,L]);let B=(0,h.useCallback)(t=>{var r;if(!e.some(e=>t.origin==="".concat(e.scheme,"://").concat(e.origin))||!t.data.type||!t.data.content)return;L();let{type:n,content:s,watchContentSize:o,tailwindStylesEnabled:i}=t.data;d(n),a(s),l(null),j(null!=i&&i),f(null!=o&&o),null==(r=t.source)||r.postMessage({type:"MESSAGE_RECEIVED",requestId:t.data.requestId},{targetOrigin:t.origin})},[e,L]);return((0,h.useEffect)(()=>(window.addEventListener("message",B),window.parent&&e.forEach(e=>{window.parent.postMessage({type:"USER_CONTENT_RENDERER_READY"},"".concat(e.scheme,"://").concat(e.origin))}),()=>window.removeEventListener("message",B)),[B,e]),(0,h.useEffect)(()=>{if(!D)return;let e=e=>{if(!(e.target instanceof HTMLElement))return;let t=e.target.closest("a");if(t&&t.href)if(e.preventDefault(),e.stopImmediatePropagation(),t.href.startsWith("blob-request:")){let e=m(t.href);if(!e)return;e.arrayBuffer().then(r=>{null==D||D(s.uZ.DownloadFile,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.DownloadFile",filename:t.download,data:r,mimeType:e.type||"application/octet-stream"})})}else if(t.href.startsWith("data:")){let[e,r]=t.href.split(","),n=e.match(/data:([^;]+)/),a=n?n[1]:"application/octet-stream",o=atob(r),l=Uint8Array.from(o,e=>e.charCodeAt(0)).buffer;null==D||D(s.uZ.DownloadFile,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.DownloadFile",filename:t.download,data:l,mimeType:a})}else{let e;try{e=new URL(t.href)}catch(e){return}if(e.hostname===window.location.hostname)return;null==D||D(s.uZ.OpenExternal,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.OpenExternal",href:t.href})}};return document.addEventListener("click",e,!1),()=>document.removeEventListener("click",e)},[D]),(0,h.useEffect)(()=>{if(!D)return;let e=e=>{let t=e.target;t instanceof HTMLElement&&"IFRAME"!==t.tagName&&(null==D||D(s.uZ.TrackInteraction,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.TrackInteraction",interactionType:"click"}))};return document.addEventListener("click",e,!0),()=>{document.removeEventListener("click",e,!0)}},[D]),R&&"sandbox"===U)?(0,n.jsx)(eQ,{error:R}):(0,n.jsx)(w.ErrorBoundary,{errorComponent:e=>{let{error:t}=e;return W({type:"RuntimeError",message:t.message}),null},children:(0,n.jsx)(S,{enabled:u,sendRequest:D,children:(r||o)&&i?(0,n.jsx)(eM,{contentType:i,textContent:r,binaryContent:o,htmlRendererRef:A,handleScreenshot:P,handleError:W,tailwindStylesEnabled:g,sendRequest:D}):N?(0,n.jsx)("div",{className:"flex min-h-full w-full items-center justify-center bg-gray-100 p-4",children:(0,n.jsx)(eP,{title:"Loading is taking longer than expected",description:"There may be an issue with the content you’re trying to load. ",subtext:"The code itself may still be valid and functional. "})}):(0,n.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-gray-100",children:(0,n.jsx)(O.k,{size:"md"})})})},r||"binary-content")}},20965:(e,t,r)=>{r.d(t,{Z:()=>d});var n=r(54568),s=r(73356),a=r(7620),o=r(90955),l=r(65255);let i={darkMode:!0,primaryColor:"#333842",secondaryColor:"#21252B",tertiaryColor:"#abb2bf",primaryTextColor:"#ABB2BF",secondaryTextColor:"#5c6370",tertiaryTextColor:"#4b5263",primaryBorderColor:"#636D83",secondaryBorderColor:"#5c6370",tertiaryBorderColor:"#4b5263",edgeLabelBackground:"#282C34",lineColor:"#636D83",textColor:"#abb2bf",pie1:"#56b6c2",pie2:"#61afef",pie3:"#c678dd",pie4:"#98c379",pie5:"#e06c75",pie6:"#d19a66",pieStrokeColor:"#2C313A",pieOuterStrokeColor:"#2C313A",fillType0:"#0d7377",fillType1:"#1f4e79",fillType2:"#8e44ad",fillType3:"#317732",fillType4:"#a31d48",fillType5:"#8f5c38",fillType6:"#a37d18",fillType7:"#4c5056"},c=()=>{let[e,t]=(0,a.useState)(null);return(0,a.useEffect)(()=>{(async()=>{try{let e=await Promise.all([r.e(3220),r.e(7078),r.e(640)]).then(r.bind(r,50640));t(e.default)}catch(e){s.v.error(s.u.USER_CONTENT_RENDERER,"Failed to load Mermaid",e)}})()},[]),e},d=e=>{let{content:t}=e,r=c();(0,a.useEffect)(()=>{null==r||r.initialize({securityLevel:"strict",theme:"base",themeCSS:".label foreignObject { overflow: visible; }",themeVariables:{fontFamily:"monospace",fontSize:"14px",...i}})},[r]),(0,a.useEffect)(()=>{r&&setTimeout(()=>{let e=document.getElementById("mermaid");null==e||e.removeAttribute("data-processed"),null==r||r.contentLoaded()},1)},[t,r]);let s=async()=>{if(document.fullscreenElement){var e,t;await (null==(e=(t=document).exitFullscreen)?void 0:e.call(t))}else await document.documentElement.requestFullscreen()};return r?(0,n.jsxs)(l.g,{style:{backgroundColor:"rgb(40, 44, 52)"},children:[(0,n.jsx)("div",{id:"mermaid",className:"mermaid flex max-h-full max-w-full grow items-center justify-center self-stretch bg-[#282C34] [&>svg]:max-h-full [&>svg]:max-w-full",children:t}),(0,n.jsx)("button",{onClick:s,className:"absolute bottom-2 right-2 z-10 rounded-md bg-[#3338421f] px-2 py-1 text-[#636D83] hover:bg-[#3338423f]"})]}):(0,n.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-gray-900",children:(0,n.jsx)(o.k,{size:"md"})})}},27694:(e,t,r)=>{r.d(t,{ClientConfigurationProvider:()=>o,t:()=>l});var n=r(54568),s=r(7620);let a=(0,s.createContext)(null);function o(e){let{children:t,value:r}=e;return(0,n.jsx)(a.Provider,{value:r,children:t})}function l(){let e=(0,s.useContext)(a);if(!e)throw Error("useClientConfiguration must be used within a ClientConfigurationProvider");return e}},37965:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{b:()=>ReplRenderer});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(54568),_ant_chat_components_Artifacts_api_actions__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(19354),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(7620);function ReplRenderer(param){let{initialCode="",sendRequest}=param,fetchData=(0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(async e=>{if(sendRequest)return(await sendRequest(_ant_chat_components_Artifacts_api_actions__WEBPACK_IMPORTED_MODULE_1__.uZ.GetFile,{key:e,"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.GetFileRequest"})).value},[sendRequest]),onFinish=(0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(e=>{null==sendRequest||sendRequest(_ant_chat_components_Artifacts_api_actions__WEBPACK_IMPORTED_MODULE_1__.uZ.SendConversationMessage,{messageType:"text",message:e,"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.SendConversationMessageRequest"})},[sendRequest]),onError=(0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(e=>{null==sendRequest||sendRequest(_ant_chat_components_Artifacts_api_actions__WEBPACK_IMPORTED_MODULE_1__.uZ.SendConversationMessage,{messageType:"error",message:e,"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.SendConversationMessageRequest"})},[sendRequest]);return(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{try{var _JSON_stringify;let res=eval(initialCode);onFinish(null!=(_JSON_stringify=JSON.stringify(res))?_JSON_stringify:"")}catch(err){onError(err instanceof Error?err.message:String(err))}},[initialCode,onError,onFinish]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{})}},50882:(e,t,r)=>{r.d(t,{c:()=>p});var n=r(54568),s=r(7620),a=r(65255),o=r(73356),l=r(77261),i=r.n(l),c=r(35078);let d=e=>{let t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([0-9.]+))?\)/);if(!t)return o.v.error(o.u.USER_CONTENT_RENDERER,"Invalid color format",{rgba:e}),e;let[,r,n,s,a="1"]=t,l=parseInt(r,10),c=parseInt(n,10),d=parseInt(s,10),u=parseFloat(a),[m,h,f]=i().rgb.hsl(l,c,d),p=Math.max(0,h-5),g=Math.max(0,f-25),[y,x,b]=i().hsl.rgb([m,p,g]);return"rgba(".concat(y,", ").concat(x,", ").concat(b,", ").concat(.8*u,")")},u=e=>{let t=new XMLSerializer().serializeToString(e),r=window.btoa(t);return"data:image/svg+xml;base64,".concat(r)},m=e=>{let t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t},h=async(e,t)=>{let r=u(e);return new Promise((e,n)=>{let s=new Image;s.onload=async()=>{let r=m(s);try{let n=await t.getColorAsync(r),s=d(n.rgba),a=n.isDark?"#fff":"#000";e({backgroundColor:s,textColor:a})}catch(e){n(e)}},s.onerror=n,s.src=r})},f=e=>{let[t,r]=(0,s.useState)(""),[n,a]=(0,s.useState)("");return(0,s.useEffect)(()=>{let t=new c.D,n=e.current;if(!n)return;let s=n.querySelector("svg");s&&h(s,t).then(e=>{let{backgroundColor:t,textColor:n}=e;r(t),a(n)}).catch(e=>{o.v.error(o.u.USER_CONTENT_RENDERER,"Error getting average color",e)})},[e]),{backgroundColor:t,textColor:n}},p=e=>{let{content:t}=e,r=(0,s.useRef)(null),{backgroundColor:o,textColor:l}=f(r);return(0,n.jsx)(a.g,{style:{backgroundColor:o,color:l},children:(0,n.jsx)("div",{id:"artifacts-component-root-svg",ref:r,className:"h-full w-full",dangerouslySetInnerHTML:{__html:t}})})}},65255:(e,t,r)=>{r.d(t,{g:()=>m});var n=r(54568),s=r(7620),a=r(43994),o=r(13522),l=r(96547),i=r(61970),c=r(4432),d=r(6845);let u=()=>{let{zoomIn:e,zoomOut:t}=(0,a._5)(),[r,u]=(0,s.useState)(!1),m=(0,s.useCallback)(()=>{let e=document,t=e.documentElement;e.fullscreenElement?e.exitFullscreen&&(e.exitFullscreen(),u(!1)):(t.requestFullscreen(),u(!0))},[]);return(0,n.jsx)("div",{className:"absolute bottom-2 right-2 z-10 flex flex-col",children:(0,n.jsxs)("div",{className:"flex flex-col gap-0.5 rounded-md border-[0.5px] border-[#636d83a0] p-0.5",children:[(0,n.jsx)(d.Button,{className:"flex !h-7 !w-7 items-center justify-center !border-0 !bg-transparent !px-0 !text-[#636D83] !shadow-none hover:!bg-[#3338421f]",variant:"outline",onClick:t=>{t.preventDefault(),e()},children:(0,n.jsx)(o.A,{size:16})}),(0,n.jsx)("div",{className:"h-[0.5px] w-full px-1",children:(0,n.jsx)("hr",{className:"border-b-[0.5px] border-t-0 border-[#636D83a0]"})}),(0,n.jsx)(d.Button,{className:"flex !h-7 !w-7 items-center justify-center !border-0 !bg-transparent !px-0 !text-[#636D83] !shadow-none hover:!bg-[#3338421f]",variant:"outline",onClick:e=>{e.preventDefault(),t()},children:(0,n.jsx)(l.A,{size:16})}),(0,n.jsx)("div",{className:"h-[0.5px] w-full px-1",children:(0,n.jsx)("hr",{className:"border-b-[0.5px] border-t-0 border-[#636D83a0]"})}),(0,n.jsx)(d.Button,{className:"flex !h-7 !w-7 items-center justify-center !border-0 !bg-transparent !px-0 !text-[#636D83] !shadow-none hover:!bg-[#3338421f]",variant:"outline",onClick:e=>{e.preventDefault(),m()},children:r?(0,n.jsx)(i.A,{size:16}):(0,n.jsx)(c.A,{size:16})})]})})},m=e=>{let{children:t,style:r}=e,[o,l]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e=()=>{l(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}},[]),(0,n.jsx)("div",{className:"".concat(o?"fixed inset-0 z-50":"h-screen w-full"," [&>.react-transform-wrapper>.react-transform-component]:flex [&>.react-transform-wrapper>.react-transform-component]:h-full [&>.react-transform-wrapper>.react-transform-component]:w-full [&>.react-transform-wrapper>.react-transform-component]:cursor-move [&>.react-transform-wrapper>.react-transform-component]:items-center [&>.react-transform-wrapper>.react-transform-component]:justify-center [&>.react-transform-wrapper>.react-transform-component]:p-4 [&>.react-transform-wrapper]:h-full [&>.react-transform-wrapper]:w-full"),style:r,children:(0,n.jsxs)(a.GT,{doubleClick:{disabled:!1},children:[(0,n.jsx)(u,{}),(0,n.jsx)(a.WZ,{children:t})]})})}},97905:(e,t,r)=>{r.d(t,{m:()=>i,x:()=>l});var n=r(73356),s=r(19354),a=r(86667);let o=new Map;class l{setupMessageListener(){window.addEventListener("message",this.boundHandleMessage,!1)}handleMessage(e){if(e.origin!==this.allowedOrigin||e.source!==this.iframe.contentWindow)return;let t=Date.now();if(t-this.lastResetTime>this.RESET_INTERVAL&&(this.messageCount=0,this.lastResetTime=t),this.messageCount++,this.messageCount>this.MAX_MESSAGES_PER_INTERVAL){window.removeEventListener("message",this.boundHandleMessage),this.onRateLimited&&this.onRateLimited();return}let r=a._s.safeParse(e.data);if(!r.success)return void n.v.warn(n.u.ARTIFACTS,"Received message does not conform to basic message shape, ignoring");let s=r.data;if("response"===s.channel)return void this.handleResponse(s);this.messageQueue.push(s),this.isConsumerRunning||this.consumeMessages()}handleResponse(e){let t=this.inFlightRequests.get(e.requestId)||o.get(e.requestId);if(void 0!==t){t(e),o.delete(e.requestId);return}}async consumeMessages(){for(this.isConsumerRunning=!0;this.messageQueue.length>0;){let e=this.messageQueue.shift();if(!e)continue;let t=s.K_.safeParse(e.method);if(!t.success){this.sendErrorResponse(e.requestId,400,"Unknown method");continue}let r=t.data,o=s.x8.safeParse(e);if(!o.success){this.sendErrorResponse(e.requestId,400,"Invalid payload content");continue}let l=o.data;if(this.requestLog.has(l.requestId)){this.sendErrorResponse(l.requestId,400,"Request ID already processed");continue}this.requestLog.set(l.requestId,{message:l,requestTimestamp:new Date().getTime()}),await this.onPermissionRequested(r).then(e=>"denied"!==e||(this.sendErrorResponse(l.requestId,403,"Permission denied"),!1)).catch(e=>(n.v.error(n.u.ARTIFACTS,"Error checking permission for method ".concat(r,":"),e),this.sendErrorResponse(l.requestId,500,"Error checking permission"),!1))&&(this.onCapabilityAction(l,this.boundSendRequest).then(e=>{var t;let r=a.Ko.parse({channel:"response",status:200,requestId:l.requestId,payload:null!=e?e:a.qs}),n=this.requestLog.get(l.requestId);n&&this.requestLog.set(l.requestId,{...n,response:r,responseTimestamp:new Date().getTime()}),null==(t=this.iframe.contentWindow)||t.postMessage(r,this.allowedOrigin)}).catch(e=>{n.v.error(n.u.ARTIFACTS,"Error processing action for method ".concat(r,":"),e),this.sendErrorResponse(l.requestId,500,"Internal server error while processing action")}),await new Promise(e=>requestAnimationFrame(e)))}this.isConsumerRunning=!1}sendErrorResponse(e,t,r){var n;let s=a.t6.parse({channel:"response",status:t,requestId:e,payload:(0,a.SV)(r)}),o=this.requestLog.get(e);o&&this.requestLog.set(e,{...o,response:s,responseTimestamp:new Date().getTime()}),null==(n=this.iframe.contentWindow)||n.postMessage(s,this.allowedOrigin)}restartListening(){window.removeEventListener("message",this.boundHandleMessage),this.messageCount=0,this.lastResetTime=Date.now(),this.setupMessageListener()}cleanup(){window.removeEventListener("message",this.boundHandleMessage),this.messageQueue=[],this.isConsumerRunning=!1,this.inFlightRequests.clear()}async sendRequest(e,t,r){return new Promise((n,l)=>{var i,c;let d=Date.now().toString(),u={channel:"request",method:e,requestId:d,payload:t},m=e=>{let t=a.Ko.safeParse(e);if(!t.success)return void l(Error("Invalid response format"));let r=t.data;if(r.status>=400){let e=a.t6.safeParse(r);e.success?l(Error(e.data.payload.error)):l(Error("Error response (".concat(r.status,")")));return}let o=s.v9.safeParse(r);o.success?n(o.data.payload):l(Error("Invalid response payload for the method"))};this.inFlightRequests.set(d,m),o.set(d,m),r&&r.length>0?null==(i=this.iframe.contentWindow)||i.postMessage(u,this.allowedOrigin,r):null==(c=this.iframe.contentWindow)||c.postMessage(u,this.allowedOrigin)})}getRequestLog(){return Array.from(this.requestLog.entries()).map(e=>{let[t,r]=e;return{...r,requestId:t}}).sort((e,t)=>t.requestTimestamp-e.requestTimestamp)}constructor({iframe:e,allowedOrigin:t,onRateLimited:r=null,onPermissionRequested:n,onCapabilityAction:s}){this.messageCount=0,this.lastResetTime=Date.now(),this.MAX_MESSAGES_PER_INTERVAL=30,this.RESET_INTERVAL=5e3,this.onRateLimited=null,this.messageQueue=[],this.isConsumerRunning=!1,this.requestLog=new Map,this.inFlightRequests=new Map,this.iframe=e,this.allowedOrigin=t,this.onRateLimited=r,this.onPermissionRequested=n,this.onCapabilityAction=s,this.boundHandleMessage=this.handleMessage.bind(this),this.boundSendRequest=this.sendRequest.bind(this),this.setupMessageListener()}}class i{setupMessageListener(){window.addEventListener("message",this.boundHandleMessage,!1)}handleMessage(e){if(!1===this.allowedOrigins.includes(e.origin)||e.source!==this.parentWindow)return;let t=a._s.safeParse(e.data);if(!t.success)return void n.v.warn(n.u.ARTIFACTS,"Received message does not conform to basic request shape, ignoring");let r=t.data;if("response"===r.channel)return void this.handleResponse(r);if(!s.Rv.safeParse(r.method).success)return void this.sendErrorResponse(r.requestId,400,"Unknown method");let o=s.OR.safeParse(r);if(!o.success)return void this.sendErrorResponse(r.requestId,400,"Invalid payload content");let l=o.data;this.onOutsideRequest(l).then(e=>{let t=a.Ko.parse({channel:"response",status:200,requestId:l.requestId,payload:null!=e?e:a.qs});this.sendMessage(t)}).catch(e=>{n.v.error(n.u.ARTIFACTS,"Error processing action for method ".concat(l.method,":"),e),this.sendErrorResponse(l.requestId,500,"Internal error while processing action")})}sendErrorResponse(e,t,r){let n=a.t6.parse({channel:"response",status:t,requestId:e,payload:(0,a.SV)(r)});this.sendMessage(n)}sendMessage(e){this.allowedOrigins.forEach(t=>{this.parentWindow.postMessage(e,t)})}cleanup(){window.removeEventListener("message",this.boundHandleMessage),this.inFlightRequests.clear()}handleResponse(e){let t=this.inFlightRequests.get(e.requestId);if(void 0!==t)return void t(e)}async sendRequest(e,t){return new Promise((r,n)=>{let o=Date.now().toString()+Math.random().toString(),l={channel:"request",method:e,requestId:o,payload:t},i=e=>{let t=a.Ko.safeParse(e);if(!t.success)return void n(Error("Invalid response format"));let o=t.data;if(o.status>=400){let e=a.t6.safeParse(o);e.success?n(Error(e.data.payload.error)):n(Error("Error response (".concat(o.status,")")));return}let l=s.sS.safeParse(o);l.success?r(l.data.payload):n(Error("Invalid response payload for the method"))};this.inFlightRequests.set(o,i),this.sendMessage(l)})}constructor({parentWindow:e,allowedOrigins:t,onOutsideRequest:r}){this.inFlightRequests=new Map,this.parentWindow=e,this.allowedOrigins=t,this.onOutsideRequest=r,this.boundHandleMessage=this.handleMessage.bind(this),this.setupMessageListener()}}}}]);